
{% extends 'base.html' %}
{% load staticfiles %} 
{% load mptt_tags %}


{% block SimeditorCss %}
<link rel="stylesheet" type="text/css" href="{% static 'blog/simeditor2.3.16/styles/simditor.css' %}" />
{% endblock SimeditorCss %}

{% block main %}

<div class="jumbotron">
        <h1>{{ post.title }}</h1>
        <p>{{ post.body }}</p>
        <p><a class="btn btn-primary btn-sm" href="#" role="button">{{ post.created_time }}</a></p>
        <p><a class="btn btn-primary btn-sm" href="#" role="button">{{ post.author }}</a></p>
        <p><a class="btn btn-primary btn-sm" href="#" role="button">{{ post.category.name }}</a></p>
</div>


<form class="form-horizontal" action="{% url 'comments:post_comments' post.pk %}" method="post" role="form">
<table>

            {% csrf_token %}
            <div class="form-group">
                 <label for="editor" class="col-sm-2 control-label">内容:</label>
                <div class="col-sm-10">
                    <textarea class="form-control" name="content" id="editor" placeholder="提出你的疑问？" autofocus></textarea>
                    <input type="hidden" name="parent" value="" />
                    <input type="hidden" name="user" value="2" />
                    <input type="hidden" name="post" value="{{ post.pk }}" />
                </div>
            </div>

            <div class="form-group">
                <label for="code" class="col-sm-2 control-label">验证:</label>
               <div class="col-sm-10">                   
                <div id="code">
                    {{ post.captcha }} 
                </div>
               </div>
            </div>

          <!--
            <div class="form-group">
                <label for="code" class="col-sm-2 control-label">验证:</label>
               <div class="col-sm-10">                   
                <div class="QapTcha" id="code">

                </div>
               </div>
            </div>

  
        <form action="{% url 'comments:post_comments' post.pk %}" method="post">
          {% csrf_token %}
          {{ form }}
          <tr>
            <td colspan="2">
              <input type="submit" name="submit" value="Post">
              <input type="submit" name="preview" value="Preview">
            </td>
          </tr>
        </form>
            <div class="form-group">
                 <label for="inputPassword3" class="col-sm-2 control-label">验证:</label>
                <div class="col-sm-10">
                    <input type="password" class="form-control" id="inputPassword3" />
                </div>
            </div>
            -->

            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
                     <input type="submit" name="submit" class="btn btn-default" value="发表"/>
                     
                </div>
            </div>
</table>
</form>


<ul class="media-list">
        {% recursetree comments_list %}
        <li class="media">
            <a class="media-left" href="#">
                {% if user.socialaccount_set.all.0.get_avatr_url %}
                <img width="30px" height="30px" alt="{{user.username}}" src="{{ user.socialaccount_set.all.0.get_avatar_url }}">
                {% else %}
                <img class="media-object" src="{% static 'blog/images/author.svg' %}" alt="{{user.username}}">
                {% endif %}
            </a>
            <div class="media-body">
                <h4 class="media-heading">
                        {{node.user}}
                </h4>
                <p>
                    {{node.content|safe}}
                </p>              
                {% if not node.is_leaf_node %}
                <!-- 嵌套的媒体对象 -->
                <ul class="media-list">
                    
                    {{ children }}
                    
                </ul>
                {% endif %}
            </div>
        </li>
        {% endrecursetree %}
 </ul>

{% endblock main%}



{% block aside %}
<div class="panel panel-default">
        <div class="panel-heading">
            <h3 class="panel-title">
                Panel title
            </h3>
        </div>
        <div class="panel-body">
            Panel content
        </div>
        <div class="panel-footer">
            Panel footer
        </div>
    </div>

{% endblock aside %}

{% block SimeditorJs %}
<script type="text/javascript" src="{% static 'blog/simeditor2.3.16/scripts/jquery.min.js' %}"></script>
<script type="text/javascript" src="{% static 'blog/simeditor2.3.16/scripts/module.js' %}"></script>
<script type="text/javascript" src="{% static 'blog/simeditor2.3.16/scripts/hotkeys.js' %} "></script>
<script type="text/javascript" src="{% static 'blog/simeditor2.3.16/scripts/uploader.js' %}"></script>
<script type="text/javascript" src="{% static 'blog/simeditor2.3.16/scripts/simditor.js' %}"></script>
<script type="text/javascript">
    var editor = new Simditor({
    textarea: $('#editor')

  });
</script>
{% endblock SimeditorJs %}

